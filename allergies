//add allergie
router.post('/user/userID', async (req,res)=>{
    
    const newAllergie = new allergieSchema(req.body);
    
    try {
        const allergieToSave = await newAllergie.save();
        if(!newAllergie) throw Error('Problem mit dem Speichern der Allergie');
        console.log('Allergie saved');
        res.status(201).json(newAllergie);
    } catch (error) {
        res.status(400).json({msg:error});
    }
});

//update allergies
router.patch('/:id', async (req,res) => {
    try {
        const updateAllergie = await allergieSchema.findByIdAndUpdate(req.params.id,req.body);
        if(!updateAllergie) throw Error ('Allergie not found');
        res.status(200).json({success : true});
    } catch (error) {
        res.status(400).json({msg:error});
    }
});

//delete allergie
router.delete('/:id', async (req,res) =>{
    try {
        const deleteAllergie = await allergieSchema.findByIdAndDelete(req.params.id);
        if (!deleteAllergie) throw Error ('Allergie nor Found');
        res.status(200).json({deleted : true});
    } catch (error) {
        res.status(400).json({msg:error});
    }
});

//get allergie
//all allergies
router.get('/', async (req,res) => {
    try {
        const allergieList = await allergieSchema.find()
        if(!allergieSchema) throw Error ('No Allergies');
        res.status(200).json(allergieList);
    } catch (error) {
        res.status(400).json({msg:error});
    }
});